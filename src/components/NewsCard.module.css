/* Путь: frontend/src/components/NewsCard.module.css
   Назначение: Стили карточки NewsCard в ленте.

   FIX (2026-02-17 CARD SIZE TUNED):
   - Базовый размер через aspect-ratio у .mediaWrap (3:2).
   - Модификатор .cardLarge делает карточку чуть выше (4:3), а не квадратной.

   FIX (2026-02-18 META ALIGN):
   - .body — flex-колонка.
   - .content — внутренний flex-блок для текста.
   - .meta прижата к низу карточки через margin-top: auto.
*/

/* === Токены под темы (графит + белая) === */
:global(:root),
:root,
:global(body.theme-graphite),
body.theme-graphite,
:global(.theme-graphite),
.theme-graphite {
  --bg-card: #191d24;
  --text: #f0f2f6;
  --muted: #9aa4b2;
  --border-soft: rgba(255, 255, 255, 0.08);
  --accent: #f9c85c;
}

:global(body.theme-white),
body.theme-white,
:global(.theme-white),
.theme-white {
  --bg-card: #ffffff;
  --text: #111111;
  --muted: #555555;
  --border-soft: rgba(0, 0, 0, 0.08);
  --accent: #1a4b9a;
}

/* === Карточка === */
.card {
  display: flex;
  flex-direction: column;
  background: var(--bg-card);
  border: none;
  box-shadow:
    inset 0 0 0 1px var(--border-soft),
    0 10px 26px rgba(0, 0, 0, 0.35);
  border-radius: 14px;
  overflow: hidden;
  transition:
    transform 0.12s ease,
    box-shadow 0.12s ease,
    background 0.3s ease,
    color 0.3s ease;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow:
    inset 0 0 0 1px color-mix(in srgb, var(--border-soft) 60%, var(--accent) 40%),
    0 14px 30px rgba(0, 0, 0, 0.4);
}

/* Модификатор для крупных карточек (главная лента) */
.cardLarge .mediaWrap {
  /* Был квадрат 1/1 — делаем чуть ниже, чтобы не были слишком большими */
  aspect-ratio: 4 / 3;
}

/* === Обёртка изображения === */
.mediaWrap {
  position: relative;
  display: block;

  /* Базовый размер для всех карточек */
  aspect-ratio: 3 / 2;

  background: #0b0d11;
  overflow: hidden;
  isolation: isolate;
}

/* Сам <img> растягивается на всю высоту контейнера */
.media {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
  background-color: #0b0d11;
}

/* затемнение нижней части изображения */
.mediaWrap::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 45%;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.55), transparent);
  pointer-events: none;
}

/* === Тело карточки === */
.body {
  padding: 12px 14px 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* Внутренний блок: заголовок + автор + источник */
.content {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* === Заголовок === */
.title {
  font-size: 16px;
  line-height: 1.25;
  margin: 0;
}

.title a {
  color: var(--text);
  text-decoration: none;
  transition: color 0.2s ease;
}

.title a:hover {
  text-decoration: underline;
  color: var(--accent);
}

/* === Источник (текстовая строка, когда нет картинки) === */
.sourceLine {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  opacity: 0.9;
  font-size: 12px;
  color: var(--muted);
}

.sourceDot {
  width: 6px;
  height: 6px;
  background: var(--muted);
  border-radius: 50%;
}

.sourceText {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* === Метаданные === */
.meta {
  margin-top: auto; /* прижимаем категорию+дату к низу тела карточки */
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--muted);
  font-size: 12px;
}

.cat {
  padding: 4px 8px;
  background: rgba(154, 164, 178, 0.12);
  border: 1px solid rgba(154, 164, 178, 0.18);
  border-radius: 999px;
  color: var(--text);
}

.card:hover .cat {
  background: rgba(249, 200, 92, 0.15);
  color: var(--accent);
}

/* === Появление карточки === */
.card {
  opacity: 0;
  transform: translateY(10px);
  transition:
    opacity 0.5s ease,
    transform 0.5s ease,
    box-shadow 0.12s ease,
    background 0.3s ease,
    color 0.3s ease;
}

.card.visible {
  opacity: 1;
  transform: translateY(0);
}

/* =========================================================
   MOBILE FIX
   ========================================================= */
@media (max-width: 768px) {
  .mediaWrap::after {
    height: 32%;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.30) 0%,
      rgba(0, 0, 0, 0.14) 45%,
      transparent 100%
    );
    transform: translateZ(0);
    backface-visibility: hidden;
    will-change: opacity, transform;
  }

  .media {
    transform: translateZ(0);
    backface-visibility: hidden;
  }
}

@media (max-width: 768px) {
  .card {
    box-shadow: inset 0 0 0 1px var(--border-soft) !important;
    transform: none !important;
    transition:
      opacity 0.35s ease,
      background 0.3s ease,
      color 0.3s ease !important;
  }

  .card:hover {
    transform: none !important;
    box-shadow: inset 0 0 0 1px var(--border-soft) !important;
  }

  .mediaWrap::after {
    display: none !important;
  }
}
